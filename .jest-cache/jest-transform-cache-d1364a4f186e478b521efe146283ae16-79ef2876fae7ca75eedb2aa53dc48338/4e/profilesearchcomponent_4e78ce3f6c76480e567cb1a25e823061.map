{"file":"/Users/gargam/Develop/hpo-web/src/app/browser/pages/profile-search/profile-search.component.ts","mappings":"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","names":[],"sources":["/Users/gargam/Develop/hpo-web/src/app/browser/pages/profile-search/profile-search.component.ts"],"sourcesContent":["import { Component, OnInit, ViewChild } from '@angular/core';\nimport { MatTableDataSource } from '@angular/material/table';\nimport { Observable, of } from 'rxjs';\nimport { UntypedFormControl } from \"@angular/forms\";\nimport { catchError, debounceTime, distinctUntilChanged, filter, map, switchMap } from 'rxjs/operators';\nimport { AnnotationService } from '../../services/annotation/annotation.service';\nimport { OntologyService } from '../../services/ontology/ontology.service';\nimport { MatStepper } from \"@angular/material/stepper\";\nimport { MatSort } from \"@angular/material/sort\";\nimport { SimpleTerm } from '../../models/models';\n\n@Component({\n  selector: 'app-custom',\n  templateUrl: './profile-search.component.html',\n  styleUrls: ['./profile-search.component.scss']\n})\nexport class ProfileSearchComponent implements OnInit {\n\n  @ViewChild('stepper') stepper: MatStepper;\n  @ViewChild(MatSort) sort: MatSort;\n\n  myControl = new UntypedFormControl();\n  filteredOptions: Observable<SimpleTerm[]>;\n  selectedTerms: SimpleTerm[] = [];\n  submittedTerms = false;\n  dataSource: MatTableDataSource<SimpleTerm>;\n  associationData;\n  loadingIntersectingAssociations = true;\n  intersectingAssocationError = false;\n  displayedColumns: string[] = ['diseaseId', 'diseaseName'];\n  resultsLength = 0;\n\n  constructor(private ontologyService: OntologyService,  private annotationService: AnnotationService) {\n  }\n\n  ngOnInit(): void {\n    this.filteredOptions = this.myControl.valueChanges\n      .pipe(\n        filter(x => x != null && x != '' && x.length >= 3),\n        switchMap(val =>\n          this.ontologyService.search(val, 10)\n        ),\n        map(response => response.terms)\n      );\n  }\n\n  addTerm(term: any) {\n    if (!this.selectedTerms.some(existent => existent.id == term.id)) {\n      this.selectedTerms.push(term);\n    }\n  }\n\n  removeTerm(index: number) {\n    this.selectedTerms.splice(index);\n  }\n\n  submitTerms() {\n    this.stepper.next();\n    this.submittedTerms = true;\n    this.loadingIntersectingAssociations = true;\n    const termIds = this.selectedTerms.map(term => term.id);\n    this.annotationService.searchProfile(termIds.join(\",\")).pipe(\n      debounceTime(1000),\n      distinctUntilChanged(),\n      map(data => {\n        this.loadingIntersectingAssociations = false;\n        this.resultsLength = data.length;\n        return data;\n      }),\n      catchError(() => {\n        this.intersectingAssocationError = true;\n        this.loadingIntersectingAssociations = false;\n        return of([]);\n      })\n    ).subscribe(data =>\n      this.dataSource = new MatTableDataSource(data)\n    );\n  }\n\n  applyTermFilter(filterValue: string) {\n    filterValue = filterValue.trim(); // Remove whitespace\n    filterValue = filterValue.toLowerCase(); // MatTableDataSource defaults to lowercase matches\n    this.dataSource.filter = filterValue;\n  }\n\n  resetStepper() {\n    this.stepper.reset();\n    this.submittedTerms = false;\n    this.selectedTerms = [];\n    this.myControl.reset();\n  }\n}\n"],"version":3}