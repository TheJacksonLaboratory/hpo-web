c5ed887b3d8e9fc8788949189610a07e
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.GeneService = void 0;
const tslib_1 = require("tslib");
const core_1 = require("@angular/core");
const http_1 = require("@angular/common/http");
const environment_1 = require("../../../../environments/environment");
const operators_1 = require("rxjs/operators");
let GeneService = class GeneService {
    constructor(http) {
        this.http = http;
        this.options = {
            headers: new http_1.HttpHeaders({
                'Content-Type': 'application/json',
                'Accept': 'q=0.8;application/json;q=0.9'
            })
        };
    }
    searchGeneInfo(query) {
        return this.http
            .get(environment_1.environment.HPO_ENTREZ_SEARCH_URL + '?db=gene&id=' + query + '&retmode=json');
    }
    searchUniprot(query) {
        let params = new http_1.HttpParams();
        params = params.append('from', 'P_ENTREZGENEID');
        params = params.append('to', 'ACC');
        params = params.append('query', query);
        params = params.append('format', 'tab');
        params = params.append('columns', 'id,reviewed');
        return this.http
            .post(environment_1.environment.HPO_UNIPROT_MAPPING_URL, null, { params: params, responseType: 'text' })
            .pipe((0, operators_1.map)(res => this.parseUniprotMapping(res.split('\n'))));
    }
    // Uniprot respopnses are in a tab seperated format.
    // Particularly a response could have multiple proteins for a gene,
    // however we only want the review one, if it has one otherwise assume it does not.
    parseUniprotMapping(lines) {
        const reviewed = lines.map(line => line.split('\t'))
            .filter(line => line[1] === 'reviewed');
        return ((reviewed.length > 0) ? reviewed[0][0] : null);
    }
    static { this.ctorParameters = () => [
        { type: http_1.HttpClient }
    ]; }
};
exports.GeneService = GeneService;
exports.GeneService = GeneService = tslib_1.__decorate([
    (0, core_1.Injectable)(),
    tslib_1.__metadata("design:paramtypes", [http_1.HttpClient])
], GeneService);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL2dhcmdhbS9EZXZlbG9wL2hwby13ZWIvc3JjL2FwcC9icm93c2VyL3NlcnZpY2VzL2dlbmUvZ2VuZS5zZXJ2aWNlLnRzIiwibWFwcGluZ3MiOiI7Ozs7QUFBQSx3Q0FBMkM7QUFDM0MsK0NBQTJFO0FBQzNFLHNFQUFtRTtBQUNuRSw4Q0FBcUM7QUFJOUIsSUFBTSxXQUFXLEdBQWpCLE1BQU0sV0FBVztJQVF0QixZQUFvQixJQUFnQjtRQUFoQixTQUFJLEdBQUosSUFBSSxDQUFZO1FBUHBDLFlBQU8sR0FBRztZQUNSLE9BQU8sRUFBRSxJQUFJLGtCQUFXLENBQUM7Z0JBQ3ZCLGNBQWMsRUFBRSxrQkFBa0I7Z0JBQ2xDLFFBQVEsRUFBRSw4QkFBOEI7YUFDekMsQ0FBQztTQUNILENBQUM7SUFHRixDQUFDO0lBRUQsY0FBYyxDQUFDLEtBQWE7UUFDMUIsT0FBTyxJQUFJLENBQUMsSUFBSTthQUNiLEdBQUcsQ0FBQyx5QkFBVyxDQUFDLHFCQUFxQixHQUFHLGNBQWMsR0FBRyxLQUFLLEdBQUcsZUFBZSxDQUFDLENBQUM7SUFDdkYsQ0FBQztJQUVELGFBQWEsQ0FBQyxLQUFhO1FBQ3pCLElBQUksTUFBTSxHQUFHLElBQUksaUJBQVUsRUFBRSxDQUFDO1FBQzlCLE1BQU0sR0FBRyxNQUFNLENBQUMsTUFBTSxDQUFDLE1BQU0sRUFBRSxnQkFBZ0IsQ0FBQyxDQUFDO1FBQ2pELE1BQU0sR0FBRyxNQUFNLENBQUMsTUFBTSxDQUFDLElBQUksRUFBRSxLQUFLLENBQUMsQ0FBQztRQUNwQyxNQUFNLEdBQUcsTUFBTSxDQUFDLE1BQU0sQ0FBQyxPQUFPLEVBQUUsS0FBSyxDQUFDLENBQUM7UUFDdkMsTUFBTSxHQUFHLE1BQU0sQ0FBQyxNQUFNLENBQUMsUUFBUSxFQUFFLEtBQUssQ0FBQyxDQUFDO1FBQ3hDLE1BQU0sR0FBRyxNQUFNLENBQUMsTUFBTSxDQUFDLFNBQVMsRUFBRSxhQUFhLENBQUMsQ0FBQztRQUNqRCxPQUFPLElBQUksQ0FBQyxJQUFJO2FBQ2IsSUFBSSxDQUFDLHlCQUFXLENBQUMsdUJBQXVCLEVBQUUsSUFBSSxFQUFFLEVBQUUsTUFBTSxFQUFFLE1BQU0sRUFBRSxZQUFZLEVBQUUsTUFBTSxFQUFFLENBQUM7YUFDekYsSUFBSSxDQUFDLElBQUEsZUFBRyxFQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFDLG1CQUFtQixDQUFDLEdBQUcsQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7SUFDakUsQ0FBQztJQUVELG9EQUFvRDtJQUNwRCxtRUFBbUU7SUFDbkUsbUZBQW1GO0lBQzNFLG1CQUFtQixDQUFDLEtBQWU7UUFDekMsTUFBTSxRQUFRLEdBQUcsS0FBSyxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLENBQUM7YUFDakQsTUFBTSxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxLQUFLLFVBQVUsQ0FBQyxDQUFDO1FBRTFDLE9BQU8sQ0FBQyxDQUFDLFFBQVEsQ0FBQyxNQUFNLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDekQsQ0FBQzs7Ozs7QUFwQ1Usa0NBQVc7c0JBQVgsV0FBVztJQUR2QixJQUFBLGlCQUFVLEdBQUU7NkNBU2UsaUJBQVU7R0FSekIsV0FBVyxDQXFDdkIiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiL1VzZXJzL2dhcmdhbS9EZXZlbG9wL2hwby13ZWIvc3JjL2FwcC9icm93c2VyL3NlcnZpY2VzL2dlbmUvZ2VuZS5zZXJ2aWNlLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEluamVjdGFibGUgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IEh0dHBDbGllbnQsIEh0dHBIZWFkZXJzLCBIdHRwUGFyYW1zIH0gZnJvbSAnQGFuZ3VsYXIvY29tbW9uL2h0dHAnO1xuaW1wb3J0IHsgZW52aXJvbm1lbnQgfSBmcm9tICcuLi8uLi8uLi8uLi9lbnZpcm9ubWVudHMvZW52aXJvbm1lbnQnO1xuaW1wb3J0IHsgbWFwIH0gZnJvbSAncnhqcy9vcGVyYXRvcnMnO1xuaW1wb3J0IHsgT2JzZXJ2YWJsZSB9IGZyb20gJ3J4anMnO1xuXG5ASW5qZWN0YWJsZSgpXG5leHBvcnQgY2xhc3MgR2VuZVNlcnZpY2Uge1xuICBvcHRpb25zID0ge1xuICAgIGhlYWRlcnM6IG5ldyBIdHRwSGVhZGVycyh7XG4gICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgJ0FjY2VwdCc6ICdxPTAuODthcHBsaWNhdGlvbi9qc29uO3E9MC45J1xuICAgIH0pXG4gIH07XG5cbiAgY29uc3RydWN0b3IocHJpdmF0ZSBodHRwOiBIdHRwQ2xpZW50KSB7XG4gIH1cblxuICBzZWFyY2hHZW5lSW5mbyhxdWVyeTogc3RyaW5nKTogT2JzZXJ2YWJsZTxhbnk+IHtcbiAgICByZXR1cm4gdGhpcy5odHRwXG4gICAgICAuZ2V0KGVudmlyb25tZW50LkhQT19FTlRSRVpfU0VBUkNIX1VSTCArICc/ZGI9Z2VuZSZpZD0nICsgcXVlcnkgKyAnJnJldG1vZGU9anNvbicpO1xuICB9XG5cbiAgc2VhcmNoVW5pcHJvdChxdWVyeTogc3RyaW5nKTogT2JzZXJ2YWJsZTxhbnk+IHtcbiAgICBsZXQgcGFyYW1zID0gbmV3IEh0dHBQYXJhbXMoKTtcbiAgICBwYXJhbXMgPSBwYXJhbXMuYXBwZW5kKCdmcm9tJywgJ1BfRU5UUkVaR0VORUlEJyk7XG4gICAgcGFyYW1zID0gcGFyYW1zLmFwcGVuZCgndG8nLCAnQUNDJyk7XG4gICAgcGFyYW1zID0gcGFyYW1zLmFwcGVuZCgncXVlcnknLCBxdWVyeSk7XG4gICAgcGFyYW1zID0gcGFyYW1zLmFwcGVuZCgnZm9ybWF0JywgJ3RhYicpO1xuICAgIHBhcmFtcyA9IHBhcmFtcy5hcHBlbmQoJ2NvbHVtbnMnLCAnaWQscmV2aWV3ZWQnKTtcbiAgICByZXR1cm4gdGhpcy5odHRwXG4gICAgICAucG9zdChlbnZpcm9ubWVudC5IUE9fVU5JUFJPVF9NQVBQSU5HX1VSTCwgbnVsbCwgeyBwYXJhbXM6IHBhcmFtcywgcmVzcG9uc2VUeXBlOiAndGV4dCcgfSlcbiAgICAgIC5waXBlKG1hcChyZXMgPT4gdGhpcy5wYXJzZVVuaXByb3RNYXBwaW5nKHJlcy5zcGxpdCgnXFxuJykpKSk7XG4gIH1cblxuICAvLyBVbmlwcm90IHJlc3BvcG5zZXMgYXJlIGluIGEgdGFiIHNlcGVyYXRlZCBmb3JtYXQuXG4gIC8vIFBhcnRpY3VsYXJseSBhIHJlc3BvbnNlIGNvdWxkIGhhdmUgbXVsdGlwbGUgcHJvdGVpbnMgZm9yIGEgZ2VuZSxcbiAgLy8gaG93ZXZlciB3ZSBvbmx5IHdhbnQgdGhlIHJldmlldyBvbmUsIGlmIGl0IGhhcyBvbmUgb3RoZXJ3aXNlIGFzc3VtZSBpdCBkb2VzIG5vdC5cbiAgcHJpdmF0ZSBwYXJzZVVuaXByb3RNYXBwaW5nKGxpbmVzOiBzdHJpbmdbXSkge1xuICAgIGNvbnN0IHJldmlld2VkID0gbGluZXMubWFwKGxpbmUgPT4gbGluZS5zcGxpdCgnXFx0JykpXG4gICAgICAuZmlsdGVyKGxpbmUgPT4gbGluZVsxXSA9PT0gJ3Jldmlld2VkJyk7XG5cbiAgICByZXR1cm4gKChyZXZpZXdlZC5sZW5ndGggPiAwKSA/IHJldmlld2VkWzBdWzBdIDogbnVsbCk7XG4gIH1cbn1cbiJdLCJ2ZXJzaW9uIjozfQ==