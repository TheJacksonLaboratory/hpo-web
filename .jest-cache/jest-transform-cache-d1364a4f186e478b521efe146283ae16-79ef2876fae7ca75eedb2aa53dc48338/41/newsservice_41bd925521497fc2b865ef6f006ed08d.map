{"file":"/Users/gargam/Develop/hpo-web/src/app/shared/news/news.service.ts","mappings":"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","names":[],"sources":["/Users/gargam/Develop/hpo-web/src/app/shared/news/news.service.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\nimport { News } from '../../browser/models/models';\nimport { Observable } from 'rxjs';\nimport { HttpClient, HttpHeaders } from '@angular/common/http';\nimport { environment } from '../../../environments/environment';\nimport { map, publishReplay, refCount } from \"rxjs/operators\";\n\n@Injectable()\nexport class NewsService {\n  private allNews: any;\n  private newsObservable$: any;\n  options = {\n    headers: new HttpHeaders({\n      'Content-Type': 'application/json',\n      'Accept': 'q=0.8;application/json;q=0.9'\n    })\n  };\n\n  constructor(private http: HttpClient) {\n  }\n\n\n  /* Return a specific months news */\n  getNewsByDate(date: string): Observable<News[]> {\n    if (date) {\n      return this.getNews().pipe(\n        map(news => news[date])\n      );\n    }\n  }\n\n  /* Return all unique month-years with news*/\n  getUniqueDates(): Observable<Array<string>> {\n    return this.getNews().pipe(\n      map(news => this._getDates(news))\n    );\n  }\n\n  /* Return all month years */\n  _getDates(news: News[]): Array<string> {\n    return Object.keys(news);\n  }\n\n  /* Get the teaser news for homepage */\n  getTeaserNews(): Observable<News[]> {\n    return this.getNews().pipe(\n      map(news => this.selectTeasers(news))\n    );\n  }\n\n  /* Get the 3 most recent news items */\n  selectTeasers(allNews: News[]) {\n    let news = Object.keys(allNews).map(key => allNews[key]);\n    news = [].concat.apply([], news);\n    news.sort((a, b) => {\n      const a1 = new Date(a.date);\n      const b1 = new Date(b.date);\n      return a1 > b1 ? -1 : a1 < b1 ? 1 : 0;\n    });\n    news.forEach(function (item) {\n      const monthYear = item.date.split(',');\n      item.monthYear = monthYear[0].split(' ')[0] + monthYear[1];\n    });\n    return news.slice(0, 3);\n  }\n\n  /* Get news items from github and store it as a \"cache\" */\n  getNews(): Observable<News[]> {\n    if (!this.newsObservable$) {\n      this.newsObservable$ = this.http.get(environment.HPO_NEWS_JSON_URL).pipe(\n        publishReplay(1),\n        refCount()\n      );\n    }\n    return this.newsObservable$;\n  }\n\n  /* Get the news items from the api */\n  setAllNews(news: News[]): void {\n    this.allNews = news;\n  }\n}\n"],"version":3}