7c97a1946989106c7c609b6e691a31f6
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const gene_service_1 = require("./gene.service");
const testing_1 = require("@angular/core/testing");
const testing_2 = require("@angular/common/http/testing");
const environment_1 = require("../../../../environments/environment");
const http_1 = require("@angular/common/http");
describe('GeneServiceSpec', () => {
    beforeEach(() => {
        testing_1.TestBed.configureTestingModule({
            imports: [],
            providers: [gene_service_1.GeneService, (0, http_1.provideHttpClient)((0, http_1.withInterceptorsFromDi)()), (0, testing_2.provideHttpClientTesting)()]
        });
    });
    const query = '7157';
    it('should handle a searchGeneInfo service method ', (0, testing_1.inject)([
        testing_2.HttpTestingController, gene_service_1.GeneService
    ], (httpMock, geneService) => {
        // call our service, and once the results come in
        // expect them to have the proper data (filled in
        // using the mock below)
        geneService.searchGeneInfo(query).subscribe(geneResponse => {
            expect(geneResponse).toBeDefined();
            expect(geneResponse.result[query].description).toEqual('tumor protein p53');
            expect(geneResponse.result[query].name).toEqual('TP53');
            expect(geneResponse.result[query].chromosome).toEqual('17');
        });
        // look up our request and access it
        const request = httpMock.expectOne(environment_1.environment.HPO_ENTREZ_SEARCH_URL + '?db=gene&id=' + query + '&retmode=json');
        // verify it is a GET
        expect(request.request.method).toEqual('GET');
        // Now, provide the answer to the caller above,
        // flushing the data down the pipe to the caller and
        // triggering the test's subscribe method
        request.flush({
            'result': {
                '7157': {
                    'uid': '7157',
                    'name': 'TP53',
                    'description': 'tumor protein p53',
                    'status': '',
                    'currentid': '',
                    'chromosome': '17',
                    'geneticsource': 'genomic',
                    'maplocation': '17p13.1',
                    'otheraliases': 'BCC7, LFS1, P53, TRP53',
                    'nomenclaturesymbol': 'TP53',
                    'nomenclaturename': 'tumor protein p53',
                    'nomenclaturestatus': 'Official',
                }
            }
        });
        // make sure it actually got processed...
        httpMock.verify();
    }));
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL2dhcmdhbS9EZXZlbG9wL2hwby13ZWIvc3JjL2FwcC9icm93c2VyL3NlcnZpY2VzL2dlbmUvZ2VuZS5zZXJ2aWNlLnNwZWMudHMiLCJtYXBwaW5ncyI6Ijs7QUFBQSxpREFBNkM7QUFDN0MsbURBQXdEO0FBQ3hELDBEQUErRjtBQUMvRixzRUFBbUU7QUFDbkUsK0NBQWlGO0FBRWpGLFFBQVEsQ0FBQyxpQkFBaUIsRUFBRSxHQUFHLEVBQUU7SUFFL0IsVUFBVSxDQUFDLEdBQUcsRUFBRTtRQUNkLGlCQUFPLENBQUMsc0JBQXNCLENBQUM7WUFDL0IsT0FBTyxFQUFFLEVBQUU7WUFDWCxTQUFTLEVBQUUsQ0FBQywwQkFBVyxFQUFFLElBQUEsd0JBQWlCLEVBQUMsSUFBQSw2QkFBc0IsR0FBRSxDQUFDLEVBQUUsSUFBQSxrQ0FBd0IsR0FBRSxDQUFDO1NBQ3BHLENBQUMsQ0FBQztJQUNELENBQUMsQ0FBQyxDQUFDO0lBQ0gsTUFBTSxLQUFLLEdBQUcsTUFBTSxDQUFDO0lBRXJCLEVBQUUsQ0FBQyxnREFBZ0QsRUFBRSxJQUFBLGdCQUFNLEVBQUM7UUFDMUQsK0JBQXFCLEVBQUUsMEJBQVc7S0FDbkMsRUFBRSxDQUFDLFFBQVEsRUFBRSxXQUF3QixFQUFFLEVBQUU7UUFDeEMsaURBQWlEO1FBQ2pELGlEQUFpRDtRQUNqRCx3QkFBd0I7UUFDeEIsV0FBVyxDQUFDLGNBQWMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxTQUFTLENBQUMsWUFBWSxDQUFDLEVBQUU7WUFDekQsTUFBTSxDQUFDLFlBQVksQ0FBQyxDQUFDLFdBQVcsRUFBRSxDQUFDO1lBQ25DLE1BQU0sQ0FBQyxZQUFZLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDLFdBQVcsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxtQkFBbUIsQ0FBQyxDQUFDO1lBQzVFLE1BQU0sQ0FBQyxZQUFZLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLE9BQU8sQ0FBQyxNQUFNLENBQUMsQ0FBQztZQUN4RCxNQUFNLENBQUMsWUFBWSxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQyxVQUFVLENBQUMsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDOUQsQ0FBQyxDQUFDLENBQUM7UUFFSCxvQ0FBb0M7UUFDcEMsTUFBTSxPQUFPLEdBQUcsUUFBUSxDQUFDLFNBQVMsQ0FBQyx5QkFBVyxDQUFDLHFCQUFxQixHQUFHLGNBQWMsR0FBRyxLQUFLLEdBQUcsZUFBZSxDQUFDLENBQUM7UUFDakgscUJBQXFCO1FBQ3JCLE1BQU0sQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQyxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsQ0FBQztRQUM5QywrQ0FBK0M7UUFDL0Msb0RBQW9EO1FBQ3BELHlDQUF5QztRQUN6QyxPQUFPLENBQUMsS0FBSyxDQUNYO1lBQ0UsUUFBUSxFQUFFO2dCQUNSLE1BQU0sRUFDSjtvQkFDRSxLQUFLLEVBQUUsTUFBTTtvQkFDYixNQUFNLEVBQUUsTUFBTTtvQkFDZCxhQUFhLEVBQUUsbUJBQW1CO29CQUNsQyxRQUFRLEVBQUUsRUFBRTtvQkFDWixXQUFXLEVBQUUsRUFBRTtvQkFDZixZQUFZLEVBQUUsSUFBSTtvQkFDbEIsZUFBZSxFQUFFLFNBQVM7b0JBQzFCLGFBQWEsRUFBRSxTQUFTO29CQUN4QixjQUFjLEVBQUUsd0JBQXdCO29CQUN4QyxvQkFBb0IsRUFBRSxNQUFNO29CQUM1QixrQkFBa0IsRUFBRSxtQkFBbUI7b0JBQ3ZDLG9CQUFvQixFQUFFLFVBQVU7aUJBQ2pDO2FBQ0o7U0FDRixDQUFDLENBQUM7UUFDTCx5Q0FBeUM7UUFDekMsUUFBUSxDQUFDLE1BQU0sRUFBRSxDQUFDO0lBQ3BCLENBQUMsQ0FBQyxDQUFDLENBQUM7QUFDTixDQUFDLENBQUMsQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyIvVXNlcnMvZ2FyZ2FtL0RldmVsb3AvaHBvLXdlYi9zcmMvYXBwL2Jyb3dzZXIvc2VydmljZXMvZ2VuZS9nZW5lLnNlcnZpY2Uuc3BlYy50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBHZW5lU2VydmljZSB9IGZyb20gJy4vZ2VuZS5zZXJ2aWNlJztcbmltcG9ydCB7IGluamVjdCwgVGVzdEJlZCB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUvdGVzdGluZyc7XG5pbXBvcnQgeyBIdHRwVGVzdGluZ0NvbnRyb2xsZXIsIHByb3ZpZGVIdHRwQ2xpZW50VGVzdGluZyB9IGZyb20gJ0Bhbmd1bGFyL2NvbW1vbi9odHRwL3Rlc3RpbmcnO1xuaW1wb3J0IHsgZW52aXJvbm1lbnQgfSBmcm9tICcuLi8uLi8uLi8uLi9lbnZpcm9ubWVudHMvZW52aXJvbm1lbnQnO1xuaW1wb3J0IHsgcHJvdmlkZUh0dHBDbGllbnQsIHdpdGhJbnRlcmNlcHRvcnNGcm9tRGkgfSBmcm9tICdAYW5ndWxhci9jb21tb24vaHR0cCc7XG5cbmRlc2NyaWJlKCdHZW5lU2VydmljZVNwZWMnLCAoKSA9PiB7XG5cbiAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgVGVzdEJlZC5jb25maWd1cmVUZXN0aW5nTW9kdWxlKHtcbiAgICBpbXBvcnRzOiBbXSxcbiAgICBwcm92aWRlcnM6IFtHZW5lU2VydmljZSwgcHJvdmlkZUh0dHBDbGllbnQod2l0aEludGVyY2VwdG9yc0Zyb21EaSgpKSwgcHJvdmlkZUh0dHBDbGllbnRUZXN0aW5nKCldXG59KTtcbiAgfSk7XG4gIGNvbnN0IHF1ZXJ5ID0gJzcxNTcnO1xuXG4gIGl0KCdzaG91bGQgaGFuZGxlIGEgc2VhcmNoR2VuZUluZm8gc2VydmljZSBtZXRob2QgJywgaW5qZWN0KFtcbiAgICBIdHRwVGVzdGluZ0NvbnRyb2xsZXIsIEdlbmVTZXJ2aWNlXG4gIF0sIChodHRwTW9jaywgZ2VuZVNlcnZpY2U6IEdlbmVTZXJ2aWNlKSA9PiB7XG4gICAgLy8gY2FsbCBvdXIgc2VydmljZSwgYW5kIG9uY2UgdGhlIHJlc3VsdHMgY29tZSBpblxuICAgIC8vIGV4cGVjdCB0aGVtIHRvIGhhdmUgdGhlIHByb3BlciBkYXRhIChmaWxsZWQgaW5cbiAgICAvLyB1c2luZyB0aGUgbW9jayBiZWxvdylcbiAgICBnZW5lU2VydmljZS5zZWFyY2hHZW5lSW5mbyhxdWVyeSkuc3Vic2NyaWJlKGdlbmVSZXNwb25zZSA9PiB7XG4gICAgICBleHBlY3QoZ2VuZVJlc3BvbnNlKS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KGdlbmVSZXNwb25zZS5yZXN1bHRbcXVlcnldLmRlc2NyaXB0aW9uKS50b0VxdWFsKCd0dW1vciBwcm90ZWluIHA1MycpO1xuICAgICAgZXhwZWN0KGdlbmVSZXNwb25zZS5yZXN1bHRbcXVlcnldLm5hbWUpLnRvRXF1YWwoJ1RQNTMnKTtcbiAgICAgIGV4cGVjdChnZW5lUmVzcG9uc2UucmVzdWx0W3F1ZXJ5XS5jaHJvbW9zb21lKS50b0VxdWFsKCcxNycpO1xuICAgIH0pO1xuXG4gICAgLy8gbG9vayB1cCBvdXIgcmVxdWVzdCBhbmQgYWNjZXNzIGl0XG4gICAgY29uc3QgcmVxdWVzdCA9IGh0dHBNb2NrLmV4cGVjdE9uZShlbnZpcm9ubWVudC5IUE9fRU5UUkVaX1NFQVJDSF9VUkwgKyAnP2RiPWdlbmUmaWQ9JyArIHF1ZXJ5ICsgJyZyZXRtb2RlPWpzb24nKTtcbiAgICAvLyB2ZXJpZnkgaXQgaXMgYSBHRVRcbiAgICBleHBlY3QocmVxdWVzdC5yZXF1ZXN0Lm1ldGhvZCkudG9FcXVhbCgnR0VUJyk7XG4gICAgLy8gTm93LCBwcm92aWRlIHRoZSBhbnN3ZXIgdG8gdGhlIGNhbGxlciBhYm92ZSxcbiAgICAvLyBmbHVzaGluZyB0aGUgZGF0YSBkb3duIHRoZSBwaXBlIHRvIHRoZSBjYWxsZXIgYW5kXG4gICAgLy8gdHJpZ2dlcmluZyB0aGUgdGVzdCdzIHN1YnNjcmliZSBtZXRob2RcbiAgICByZXF1ZXN0LmZsdXNoKFxuICAgICAge1xuICAgICAgICAncmVzdWx0Jzoge1xuICAgICAgICAgICc3MTU3JzpcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgJ3VpZCc6ICc3MTU3JyxcbiAgICAgICAgICAgICAgJ25hbWUnOiAnVFA1MycsXG4gICAgICAgICAgICAgICdkZXNjcmlwdGlvbic6ICd0dW1vciBwcm90ZWluIHA1MycsXG4gICAgICAgICAgICAgICdzdGF0dXMnOiAnJyxcbiAgICAgICAgICAgICAgJ2N1cnJlbnRpZCc6ICcnLFxuICAgICAgICAgICAgICAnY2hyb21vc29tZSc6ICcxNycsXG4gICAgICAgICAgICAgICdnZW5ldGljc291cmNlJzogJ2dlbm9taWMnLFxuICAgICAgICAgICAgICAnbWFwbG9jYXRpb24nOiAnMTdwMTMuMScsXG4gICAgICAgICAgICAgICdvdGhlcmFsaWFzZXMnOiAnQkNDNywgTEZTMSwgUDUzLCBUUlA1MycsXG4gICAgICAgICAgICAgICdub21lbmNsYXR1cmVzeW1ib2wnOiAnVFA1MycsXG4gICAgICAgICAgICAgICdub21lbmNsYXR1cmVuYW1lJzogJ3R1bW9yIHByb3RlaW4gcDUzJyxcbiAgICAgICAgICAgICAgJ25vbWVuY2xhdHVyZXN0YXR1cyc6ICdPZmZpY2lhbCcsXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIC8vIG1ha2Ugc3VyZSBpdCBhY3R1YWxseSBnb3QgcHJvY2Vzc2VkLi4uXG4gICAgaHR0cE1vY2sudmVyaWZ5KCk7XG4gIH0pKTtcbn0pO1xuIl0sInZlcnNpb24iOjN9