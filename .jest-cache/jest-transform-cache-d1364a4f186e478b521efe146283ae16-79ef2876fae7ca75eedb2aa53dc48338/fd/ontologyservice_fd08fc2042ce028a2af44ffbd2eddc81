ffb9278351be35fe47ba6fb7a11267eb
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.OntologyService = void 0;
const tslib_1 = require("tslib");
const http_1 = require("@angular/common/http");
const core_1 = require("@angular/core");
const operators_1 = require("rxjs/operators");
const environment_1 = require("../../../../environments/environment");
const language_service_1 = require("../language/language.service");
let OntologyService = class OntologyService {
    constructor(httpClient, languageService) {
        this.httpClient = httpClient;
        this.languageService = languageService;
    }
    search(query, limit) {
        return this.httpClient.get(`${environment_1.environment.ONTOLOGY_API_HP_SEARCH}?q=${query}&limit=${limit}`);
    }
    term(id) {
        return this.httpClient.get(environment_1.environment.ONTOLOGY_API_HP_TERMS + id)
            .pipe((0, operators_1.map)((data) => {
            data.translations?.map((language) => {
                language.language = language.language.toLocaleLowerCase();
                language.language_long = this.languageService.languageLookup[language.language];
            });
            data.translations?.sort((a, b) => a.language_long.localeCompare(b.language_long));
            return data;
        }));
    }
    parents(id) {
        return this.httpClient.get(environment_1.environment.ONTOLOGY_API_HP_TERMS + id + '/parents').pipe((0, operators_1.map)((terms) => {
            return terms.map((t) => {
                t.translations?.map((language) => {
                    language.language = language.language.toLocaleLowerCase();
                    language.language_long = this.languageService.languageLookup[language.language];
                });
                t.translations?.sort((a, b) => a.language_long.localeCompare(b.language_long));
                return t;
            });
        }));
    }
    children(id) {
        return this.httpClient.get(environment_1.environment.ONTOLOGY_API_HP_TERMS + id + '/children').pipe((0, operators_1.map)((terms) => {
            return terms.map((t) => {
                t.translations?.map((language) => {
                    language.language = language.language.toLocaleLowerCase();
                    language.language_long = this.languageService.languageLookup[language.language];
                });
                t.translations?.sort((a, b) => a.language_long.localeCompare(b.language_long));
                return t;
            });
        }));
    }
    static { this.ctorParameters = () => [
        { type: http_1.HttpClient },
        { type: language_service_1.LanguageService }
    ]; }
};
exports.OntologyService = OntologyService;
exports.OntologyService = OntologyService = tslib_1.__decorate([
    (0, core_1.Injectable)({ providedIn: 'root' }),
    tslib_1.__metadata("design:paramtypes", [http_1.HttpClient, language_service_1.LanguageService])
], OntologyService);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL2dhcmdhbS9EZXZlbG9wL2hwby13ZWIvc3JjL2FwcC9icm93c2VyL3NlcnZpY2VzL29udG9sb2d5L29udG9sb2d5LnNlcnZpY2UudHMiLCJtYXBwaW5ncyI6Ijs7OztBQUFBLCtDQUFrRDtBQUNsRCx3Q0FBMkM7QUFFM0MsOENBQXFDO0FBQ3JDLHNFQUFtRTtBQUVuRSxtRUFBK0Q7QUFHeEQsSUFBTSxlQUFlLEdBQXJCLE1BQU0sZUFBZTtJQUUxQixZQUFvQixVQUFzQixFQUFVLGVBQWdDO1FBQWhFLGVBQVUsR0FBVixVQUFVLENBQVk7UUFBVSxvQkFBZSxHQUFmLGVBQWUsQ0FBaUI7SUFBRyxDQUFDO0lBRXhGLE1BQU0sQ0FBQyxLQUFhLEVBQUUsS0FBYTtRQUNqQyxPQUFPLElBQUksQ0FBQyxVQUFVLENBQUMsR0FBRyxDQUF5QixHQUFHLHlCQUFXLENBQUMsc0JBQXNCLE1BQU0sS0FBSyxVQUFVLEtBQUssRUFBRSxDQUFDLENBQUM7SUFDeEgsQ0FBQztJQUVELElBQUksQ0FBQyxFQUFVO1FBQ2IsT0FBTyxJQUFJLENBQUMsVUFBVSxDQUFDLEdBQUcsQ0FBTyx5QkFBVyxDQUFDLHFCQUFxQixHQUFHLEVBQUUsQ0FBQzthQUN2RSxJQUFJLENBQ0gsSUFBQSxlQUFHLEVBQUMsQ0FBQyxJQUFJLEVBQUUsRUFBRTtZQUNiLElBQUksQ0FBQyxZQUFZLEVBQUUsR0FBRyxDQUFDLENBQUMsUUFBUSxFQUFFLEVBQUU7Z0JBQ2xDLFFBQVEsQ0FBQyxRQUFRLEdBQUcsUUFBUSxDQUFDLFFBQVEsQ0FBQyxpQkFBaUIsRUFBRSxDQUFBO2dCQUN6RCxRQUFRLENBQUMsYUFBYSxHQUFHLElBQUksQ0FBQyxlQUFlLENBQUMsY0FBYyxDQUFDLFFBQVEsQ0FBQyxRQUFRLENBQUMsQ0FBQztZQUNsRixDQUFDLENBQUMsQ0FBQztZQUNILElBQUksQ0FBQyxZQUFZLEVBQUUsSUFBSSxDQUFDLENBQUMsQ0FBVyxFQUFFLENBQVcsRUFBRSxFQUFFLENBQUMsQ0FBQyxDQUFDLGFBQWEsQ0FBQyxhQUFhLENBQUMsQ0FBQyxDQUFDLGFBQWEsQ0FBQyxDQUFDLENBQUM7WUFDdEcsT0FBTyxJQUFJLENBQUM7UUFDZCxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBQ04sQ0FBQztJQUVELE9BQU8sQ0FBQyxFQUFVO1FBQ2hCLE9BQU8sSUFBSSxDQUFDLFVBQVUsQ0FBQyxHQUFHLENBQVMseUJBQVcsQ0FBQyxxQkFBcUIsR0FBRyxFQUFFLEdBQUUsVUFBVSxDQUFDLENBQUMsSUFBSSxDQUN6RixJQUFBLGVBQUcsRUFBQyxDQUFDLEtBQUssRUFBRSxFQUFFO1lBQ1osT0FBTyxLQUFLLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxFQUFFLEVBQUU7Z0JBQ3JCLENBQUMsQ0FBQyxZQUFZLEVBQUUsR0FBRyxDQUFDLENBQUMsUUFBUSxFQUFFLEVBQUU7b0JBQy9CLFFBQVEsQ0FBQyxRQUFRLEdBQUcsUUFBUSxDQUFDLFFBQVEsQ0FBQyxpQkFBaUIsRUFBRSxDQUFBO29CQUN6RCxRQUFRLENBQUMsYUFBYSxHQUFHLElBQUksQ0FBQyxlQUFlLENBQUMsY0FBYyxDQUFDLFFBQVEsQ0FBQyxRQUFRLENBQUMsQ0FBQztnQkFDbEYsQ0FBQyxDQUFDLENBQUM7Z0JBQ0gsQ0FBQyxDQUFDLFlBQVksRUFBRSxJQUFJLENBQUMsQ0FBQyxDQUFXLEVBQUUsQ0FBVyxFQUFFLEVBQUUsQ0FBQyxDQUFDLENBQUMsYUFBYSxDQUFDLGFBQWEsQ0FBQyxDQUFDLENBQUMsYUFBYSxDQUFDLENBQUMsQ0FBQztnQkFDbkcsT0FBTyxDQUFDLENBQUM7WUFDWCxDQUFDLENBQUMsQ0FBQztRQUNMLENBQUMsQ0FBQyxDQUFDLENBQUM7SUFDUixDQUFDO0lBRUQsUUFBUSxDQUFDLEVBQVU7UUFDakIsT0FBTyxJQUFJLENBQUMsVUFBVSxDQUFDLEdBQUcsQ0FBUyx5QkFBVyxDQUFDLHFCQUFxQixHQUFHLEVBQUUsR0FBRSxXQUFXLENBQUMsQ0FBQyxJQUFJLENBQzFGLElBQUEsZUFBRyxFQUFDLENBQUMsS0FBSyxFQUFFLEVBQUU7WUFDWixPQUFPLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLEVBQUUsRUFBRTtnQkFDckIsQ0FBQyxDQUFDLFlBQVksRUFBRSxHQUFHLENBQUMsQ0FBQyxRQUFRLEVBQUUsRUFBRTtvQkFDL0IsUUFBUSxDQUFDLFFBQVEsR0FBRyxRQUFRLENBQUMsUUFBUSxDQUFDLGlCQUFpQixFQUFFLENBQUE7b0JBQ3pELFFBQVEsQ0FBQyxhQUFhLEdBQUcsSUFBSSxDQUFDLGVBQWUsQ0FBQyxjQUFjLENBQUMsUUFBUSxDQUFDLFFBQVEsQ0FBQyxDQUFDO2dCQUNsRixDQUFDLENBQUMsQ0FBQztnQkFDSCxDQUFDLENBQUMsWUFBWSxFQUFFLElBQUksQ0FBQyxDQUFDLENBQVcsRUFBRSxDQUFXLEVBQUUsRUFBRSxDQUFDLENBQUMsQ0FBQyxhQUFhLENBQUMsYUFBYSxDQUFDLENBQUMsQ0FBQyxhQUFhLENBQUMsQ0FBQyxDQUFDO2dCQUNuRyxPQUFPLENBQUMsQ0FBQztZQUNYLENBQUMsQ0FBQyxDQUFDO1FBQ0wsQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUNSLENBQUM7Ozs7OztBQS9DVSwwQ0FBZTswQkFBZixlQUFlO0lBRDNCLElBQUEsaUJBQVUsRUFBQyxFQUFFLFVBQVUsRUFBRSxNQUFNLEVBQUUsQ0FBQzs2Q0FHRCxpQkFBVSxFQUEyQixrQ0FBZTtHQUZ6RSxlQUFlLENBZ0QzQiIsIm5hbWVzIjpbXSwic291cmNlcyI6WyIvVXNlcnMvZ2FyZ2FtL0RldmVsb3AvaHBvLXdlYi9zcmMvYXBwL2Jyb3dzZXIvc2VydmljZXMvb250b2xvZ3kvb250b2xvZ3kuc2VydmljZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBIdHRwQ2xpZW50IH0gZnJvbSAnQGFuZ3VsYXIvY29tbW9uL2h0dHAnO1xuaW1wb3J0IHsgSW5qZWN0YWJsZSB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgT2JzZXJ2YWJsZSB9IGZyb20gJ3J4anMnO1xuaW1wb3J0IHsgbWFwIH0gZnJvbSAncnhqcy9vcGVyYXRvcnMnO1xuaW1wb3J0IHsgZW52aXJvbm1lbnQgfSBmcm9tICcuLi8uLi8uLi8uLi9lbnZpcm9ubWVudHMvZW52aXJvbm1lbnQnO1xuaW1wb3J0IHsgTGFuZ3VhZ2UsIE9udG9sb2d5U2VhcmNoUmVzcG9uc2UsIFRlcm0gfSBmcm9tICcuLi8uLi9tb2RlbHMvbW9kZWxzJztcbmltcG9ydCB7IExhbmd1YWdlU2VydmljZSB9IGZyb20gJy4uL2xhbmd1YWdlL2xhbmd1YWdlLnNlcnZpY2UnO1xuXG5ASW5qZWN0YWJsZSh7IHByb3ZpZGVkSW46ICdyb290JyB9KVxuZXhwb3J0IGNsYXNzIE9udG9sb2d5U2VydmljZSB7XG5cbiAgY29uc3RydWN0b3IocHJpdmF0ZSBodHRwQ2xpZW50OiBIdHRwQ2xpZW50LCBwcml2YXRlIGxhbmd1YWdlU2VydmljZTogTGFuZ3VhZ2VTZXJ2aWNlKSB7fVxuXG4gIHNlYXJjaChxdWVyeTogc3RyaW5nLCBsaW1pdDogbnVtYmVyKTogT2JzZXJ2YWJsZTxPbnRvbG9neVNlYXJjaFJlc3BvbnNlPntcbiAgICByZXR1cm4gdGhpcy5odHRwQ2xpZW50LmdldDxPbnRvbG9neVNlYXJjaFJlc3BvbnNlPihgJHtlbnZpcm9ubWVudC5PTlRPTE9HWV9BUElfSFBfU0VBUkNIfT9xPSR7cXVlcnl9JmxpbWl0PSR7bGltaXR9YCk7XG4gIH1cblxuICB0ZXJtKGlkOiBzdHJpbmcpOiBPYnNlcnZhYmxlPFRlcm0+ICB7XG4gICAgcmV0dXJuIHRoaXMuaHR0cENsaWVudC5nZXQ8VGVybT4oZW52aXJvbm1lbnQuT05UT0xPR1lfQVBJX0hQX1RFUk1TICsgaWQpXG4gICAgLnBpcGUoXG4gICAgICBtYXAoKGRhdGEpID0+IHtcbiAgICAgIGRhdGEudHJhbnNsYXRpb25zPy5tYXAoKGxhbmd1YWdlKSA9PiB7XG4gICAgICAgIGxhbmd1YWdlLmxhbmd1YWdlID0gbGFuZ3VhZ2UubGFuZ3VhZ2UudG9Mb2NhbGVMb3dlckNhc2UoKVxuICAgICAgICBsYW5ndWFnZS5sYW5ndWFnZV9sb25nID0gdGhpcy5sYW5ndWFnZVNlcnZpY2UubGFuZ3VhZ2VMb29rdXBbbGFuZ3VhZ2UubGFuZ3VhZ2VdO1xuICAgICAgfSk7XG4gICAgICBkYXRhLnRyYW5zbGF0aW9ucz8uc29ydCgoYTogTGFuZ3VhZ2UsIGI6IExhbmd1YWdlKSA9PiBhLmxhbmd1YWdlX2xvbmcubG9jYWxlQ29tcGFyZShiLmxhbmd1YWdlX2xvbmcpKTtcbiAgICAgIHJldHVybiBkYXRhO1xuICAgIH0pKTtcbiAgfVxuXG4gIHBhcmVudHMoaWQ6IHN0cmluZyk6IE9ic2VydmFibGU8VGVybVtdPiB7XG4gICAgcmV0dXJuIHRoaXMuaHR0cENsaWVudC5nZXQ8VGVybVtdPihlbnZpcm9ubWVudC5PTlRPTE9HWV9BUElfSFBfVEVSTVMgKyBpZCArJy9wYXJlbnRzJykucGlwZShcbiAgICAgIG1hcCgodGVybXMpID0+IHtcbiAgICAgICAgcmV0dXJuIHRlcm1zLm1hcCgodCkgPT4ge1xuICAgICAgICAgIHQudHJhbnNsYXRpb25zPy5tYXAoKGxhbmd1YWdlKSA9PiB7XG4gICAgICAgICAgICBsYW5ndWFnZS5sYW5ndWFnZSA9IGxhbmd1YWdlLmxhbmd1YWdlLnRvTG9jYWxlTG93ZXJDYXNlKClcbiAgICAgICAgICAgIGxhbmd1YWdlLmxhbmd1YWdlX2xvbmcgPSB0aGlzLmxhbmd1YWdlU2VydmljZS5sYW5ndWFnZUxvb2t1cFtsYW5ndWFnZS5sYW5ndWFnZV07XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgdC50cmFuc2xhdGlvbnM/LnNvcnQoKGE6IExhbmd1YWdlLCBiOiBMYW5ndWFnZSkgPT4gYS5sYW5ndWFnZV9sb25nLmxvY2FsZUNvbXBhcmUoYi5sYW5ndWFnZV9sb25nKSk7XG4gICAgICAgICAgcmV0dXJuIHQ7XG4gICAgICAgIH0pO1xuICAgICAgfSkpO1xuICB9XG5cbiAgY2hpbGRyZW4oaWQ6IHN0cmluZyk6IE9ic2VydmFibGU8VGVybVtdPiB7XG4gICAgcmV0dXJuIHRoaXMuaHR0cENsaWVudC5nZXQ8VGVybVtdPihlbnZpcm9ubWVudC5PTlRPTE9HWV9BUElfSFBfVEVSTVMgKyBpZCArJy9jaGlsZHJlbicpLnBpcGUoXG4gICAgICBtYXAoKHRlcm1zKSA9PiB7XG4gICAgICAgIHJldHVybiB0ZXJtcy5tYXAoKHQpID0+IHtcbiAgICAgICAgICB0LnRyYW5zbGF0aW9ucz8ubWFwKChsYW5ndWFnZSkgPT4ge1xuICAgICAgICAgICAgbGFuZ3VhZ2UubGFuZ3VhZ2UgPSBsYW5ndWFnZS5sYW5ndWFnZS50b0xvY2FsZUxvd2VyQ2FzZSgpXG4gICAgICAgICAgICBsYW5ndWFnZS5sYW5ndWFnZV9sb25nID0gdGhpcy5sYW5ndWFnZVNlcnZpY2UubGFuZ3VhZ2VMb29rdXBbbGFuZ3VhZ2UubGFuZ3VhZ2VdO1xuICAgICAgICAgIH0pO1xuICAgICAgICAgIHQudHJhbnNsYXRpb25zPy5zb3J0KChhOiBMYW5ndWFnZSwgYjogTGFuZ3VhZ2UpID0+IGEubGFuZ3VhZ2VfbG9uZy5sb2NhbGVDb21wYXJlKGIubGFuZ3VhZ2VfbG9uZykpO1xuICAgICAgICAgIHJldHVybiB0O1xuICAgICAgICB9KTtcbiAgICAgIH0pKTtcbiAgfVxufVxuIl0sInZlcnNpb24iOjN9