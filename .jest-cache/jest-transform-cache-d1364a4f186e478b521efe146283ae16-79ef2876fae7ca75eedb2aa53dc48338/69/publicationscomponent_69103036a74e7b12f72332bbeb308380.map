{"file":"/Users/gargam/Develop/hpo-web/src/app/static/resources/publications/publications.component.ts","mappings":"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","names":[],"sources":["/Users/gargam/Develop/hpo-web/src/app/static/resources/publications/publications.component.ts"],"sourcesContent":["import { Component, OnInit, ViewChild } from '@angular/core';\nimport { PublicationsService } from './publications.service';\nimport { Publication } from '../../../browser/models/models';\nimport { UntypedFormControl } from '@angular/forms';\nimport { from } from 'rxjs';\nimport { distinct, mergeMap, map, toArray } from 'rxjs/operators';\nimport { MatTableDataSource } from '@angular/material/table';\nimport { MatSort } from '@angular/material/sort';\n\n\n@Component({\n  selector: 'app-publications',\n  templateUrl: './publications.component.html',\n  styleUrls: ['./publications.component.scss']\n})\nexport class PublicationsComponent implements OnInit {\n\n  publications: MatTableDataSource<Publication>;\n\n  constructor(private pubService: PublicationsService) {\n  }\n\n  displayedColumns: string[] = ['authors', 'year', 'title', 'journal'];\n  category = 'all';\n  topics = new UntypedFormControl();\n  topicList = [];\n  @ViewChild(MatSort, { static: true }) sort: MatSort;\n\n  ngOnInit() {\n    this.pubService.getPublications().subscribe(publications => {\n      this.publications = new MatTableDataSource(publications);\n      this.publications.sort = this.sort;\n      this.publications.filterPredicate = this.filterPredicate;\n      this.findUniquePublicationTopics(publications);\n    });\n  }\n\n  findUniquePublicationTopics(pbs: Publication[]) {\n    const topics$ = from(pbs);\n    topics$.pipe(\n      mergeMap(pb => pb.topicList),\n      distinct(),\n      map(pb => pb.toUpperCase()),\n      toArray()\n    ).subscribe(publications => {\n      this.topicList = publications;\n    });\n  }\n\n  filterPredicate(data: Publication, filter: string) {\n    const filterVal = filter.split('~');\n    const matchesCategory = function (item: Publication, category: string) {\n      return (category === 'all' || (category === 'us' && item.inhouse === true));\n    };\n\n    // Filter by category first\n    const categoryBoolean = matchesCategory(data, filterVal[0]);\n\n    if (categoryBoolean === false) {\n      return false;\n    }\n\n    // Filter by tag\n    const topicSize = filterVal[1].split(',')[0] === '' || filterVal[1].split(',')[0] === 'null' ? 0 : filterVal[1].split(',').length;\n    const topicBool = data.topicList.map(topic => {\n      return filterVal[1].includes(topic.toUpperCase());\n    });\n\n    if (topicSize < data.topicList.length) {\n      return topicBool.filter(x => x).length === topicSize;\n    } else if (topicSize === data.topicList.length) {\n      return topicBool.every(x => x === true);\n    } else if (topicSize === 0) {\n      return true;\n    }\n    return false;\n  }\n\n  applyPublicationsFilter() {\n    this.publications.filter = this.category + '~' + this.topics.value;\n  }\n\n}\n"],"version":3}